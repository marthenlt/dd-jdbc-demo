<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:dwr="http://www.directwebremoting.org/schema/spring-dwr"
       xmlns:dwra="http://www.directwebremoting.org/schema/spring-dwr-annotations"
       xmlns:task="http://www.springframework.org/schema/task"       
       xsi:schemaLocation="http://www.springframework.org/schema/aop
                           http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
                           http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context-3.0.xsd
                           http://www.springframework.org/schema/tx 
                           http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
                           http://www.springframework.org/schema/task 
                           http://www.springframework.org/schema/task/spring-task-3.0.xsd                           
                           http://www.directwebremoting.org/schema/spring-dwr
                           http://www.directwebremoting.org/schema/spring-dwr-2.0.xsd
                           http://www.directwebremoting.org/schema/spring-dwr-annotations
                           http://www.directwebremoting.org/schema/spring-dwr-annotations.xsd">

	<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer" >
		<property name="locations">
			<list>
				<value>classpath:/resources/jdbc.properties</value>
			</list>
		</property>
	</bean>
	
	<bean id="localeResolver" class="org.springframework.web.servlet.i18n.AcceptHeaderLocaleResolver"></bean>
	
	<bean id="messageSourceAccessor" class="com.datec.type5.common.MessageSourceAccessor" factory-method="getInstance">
		<property name="messageSource" ref="messageSource" />
	</bean>
	
	<bean id="messageSource" class="com.datec.type5.common.StaticMessageSource">
		<property name="locations">
			<list>
				<value>classpath:/resources/query.xml</value>
			</list>
		</property>
	</bean>
	
	<!-- ========================= ANNOTATION CONFIGURATION ======================== -->
	<context:annotation-config/>
	<context:component-scan base-package="com.datec.type5" />
	
	<!-- ========================= COMMON RESOURCE DEFINITIONS ========================= -->
	<!-- was datasource 사용시 아래 주석 해제 -->
	<!-- 
	<bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean" >
        <property name="jndiName" value="java:comp/env/smartweb"/>
        <property name="resourceRef" value="true" />
    </bean>
      -->
      
	<bean id="ds_type5" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
		<property name="driverClassName" value="${type5.driverClassName}"/>
		<property name="url" value="${type5.url}"/>
		<property name="username" value="${type5.username}"/>
		<property name="password" value="${type5.password}"/>
        <property name="defaultAutoCommit" value="true"/>
		<!-- <property name="maxActive" value="100"/>
		<property name="maxIdle" value="50"/> -->
		<property name="maxActive" value="10"/>
		<property name="maxIdle" value="10"/>
		<property name="maxWait" value="20000"/>
		<property name="accessToUnderlyingConnectionAllowed" value="true"/>
		<property name="logAbandoned" value="true"/>
		<property name="removeAbandoned" value="true"/>
		<property name="removeAbandonedTimeout" value="60"/>
		<property name="testOnBorrow" value="false" />
		<property name="testOnReturn" value="false" />
		<property name="validationQuery" value="${type5.validationQuery}" />
		<property name="minEvictableIdleTimeMillis" value="600000" />
		<property name="timeBetweenEvictionRunsMillis" value="60000" />
		<property name="numTestsPerEvictionRun" value="5" />
		<property name="testWhileIdle" value="true" />
		<!-- 최대 connection 수 -->
		<!-- 사용되지 않고 connection pool에 저장될 수 있는 최대 connection 수 -->
		<!-- pool에 connection이 존재하지 않을때, connection이 pool에 다시 return 되기까지 대기시간 -->
		<!-- 반납이 안된 connection 삭제 시 로그파일에 기록 여부 -->
		<!-- 반납이 안되고 있는 connection 삭제 여부 -->
		<!-- 반납이 안되는 connection 이라고 DataSource가 판단시간 (1 -> 5초, 60 -> 5분) -->
		<!-- connection 요청시 해당 connection이 유효한지 체크 -->
		<!-- connection 반환시 해당 connection이 유효한지 체크 -->
		<!-- 사용되지 않은 connection을 추출할 때, 이 속성에서 지정한 시간이상 비활성화 상태인 connection만 추출한다. 양수가 아닌 경우 비활성화 된 시간으로는 pool에서 제거 안됨 -->
		<!-- 커넥션이 쉬고 있을 때 커넥션 체크 쿼리를 실행하는 시간 간격. 양수가 아닌 경우 실행되지 않음 -->
		<!-- 사용되지 않은 connection을 몇 개 검사할지 지정 -->
		<!-- true일 경우, 비횔성화 connection을 추출할 때, connection이 유효한지 검사해서 유효하지 않은 connection은 풀에서 제거 -->
	</bean>
	
	<bean id="ds_type4" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
		<property name="driverClassName" value="${type4.driverClassName}"/>
		<property name="url" value="${type4.url}"/>
		<property name="username" value="${type4.username}"/>
		<property name="password" value="${type4.password}"/>
        <property name="defaultAutoCommit" value="true"/>
		<!-- <property name="maxActive" value="100"/>
		<property name="maxIdle" value="50"/> -->
		<property name="maxActive" value="10"/>
		<property name="maxIdle" value="10"/>
		<property name="maxWait" value="20000"/>
		<property name="accessToUnderlyingConnectionAllowed" value="true"/>
		<property name="logAbandoned" value="true"/>
		<property name="removeAbandoned" value="true"/>
		<property name="removeAbandonedTimeout" value="60"/>
		<property name="testOnBorrow" value="false" />
		<property name="testOnReturn" value="false" />
		<property name="validationQuery" value="${type4.validationQuery}" />
		<property name="minEvictableIdleTimeMillis" value="600000" />
		<property name="timeBetweenEvictionRunsMillis" value="60000" />
		<property name="numTestsPerEvictionRun" value="5" />
		<property name="testWhileIdle" value="true" />
		<!-- 최대 connection 수 -->
		<!-- 사용되지 않고 connection pool에 저장될 수 있는 최대 connection 수 -->
		<!-- pool에 connection이 존재하지 않을때, connection이 pool에 다시 return 되기까지 대기시간 -->
		<!-- 반납이 안된 connection 삭제 시 로그파일에 기록 여부 -->
		<!-- 반납이 안되고 있는 connection 삭제 여부 -->
		<!-- 반납이 안되는 connection 이라고 DataSource가 판단시간 (1 -> 5초, 60 -> 5분) -->
		<!-- connection 요청시 해당 connection이 유효한지 체크 -->
		<!-- connection 반환시 해당 connection이 유효한지 체크 -->
		<!-- 사용되지 않은 connection을 추출할 때, 이 속성에서 지정한 시간이상 비활성화 상태인 connection만 추출한다. 양수가 아닌 경우 비활성화 된 시간으로는 pool에서 제거 안됨 -->
		<!-- 커넥션이 쉬고 있을 때 커넥션 체크 쿼리를 실행하는 시간 간격. 양수가 아닌 경우 실행되지 않음 -->
		<!-- 사용되지 않은 connection을 몇 개 검사할지 지정 -->
		<!-- true일 경우, 비횔성화 connection을 추출할 때, connection이 유효한지 검사해서 유효하지 않은 connection은 풀에서 제거 -->
	</bean>
	 
	<!-- JNDI
	<bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
		<property name="jndiName" value="${jdbc.jndi.jndiName}"/>
		<property name="lookupOnStartup" value="${jdbc.jndi.lookupOnStartup}"/>
		<property name="cache" value="${jdbc.jndi.cache}"/>
		<property name="proxyInterface" value="${jdbc.jndi.proxyInterface}"/>
	</bean>-->
	
	
	<!-- 추가 DataSource 선언 -->
	<!-- 이후 공통 DAO, SERVICE 클래스를 하나씩 더 생성한 후 -->
	<!-- SimpleController 에 같이 등록하여서 사용 또는 각 클래스에서 참조하여 사용한다. -->
	<!-- 
	<bean id="otherDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="${jdbc.driverClassName}"/>
        <property name="url" value="${jdbc.other.url}"/>
        <property name="username" value="${jdbc.other.username}"/>
        <property name="password" value="${jdbc.other.password}"/>
        <property name="defaultAutoCommit" value="true"/>
        <property name="maxActive" value="100"/>
        <property name="maxIdle" value="50"/>
        <property name="maxWait" value="20000"/>
        <property name="logAbandoned" value="true"/>
        <property name="removeAbandoned" value="true"/>
        <property name="removeAbandonedTimeout" value="60"/>
        <property name="testOnBorrow" value="false" />
        <property name="testOnReturn" value="false" />
        <property name="validationQuery" value="${jdbc.other.validationQuery}" />
        <property name="minEvictableIdleTimeMillis" value="600000" />
        <property name="timeBetweenEvictionRunsMillis" value="60000" />
        <property name="numTestsPerEvictionRun" value="5" />
        <property name="testWhileIdle" value="true" />
    </bean>
	
	<bean id="otherSqlMapClient" class="org.springframework.orm.ibatis.SqlMapClientFactoryBean">
        <property name="configLocation" value="classpath:resources/sql/sqlmap-other-config.xml" />
        <property name="dataSource" ref="otherDataSource" />
    </bean>
    
    <bean id="otherSqlMapClientTemplate" class="org.springframework.orm.ibatis.SqlMapClientTemplate">
        <property name="sqlMapClient" ref="otherSqlMapClient"/>
    </bean>
	 -->
    
</beans>           